# Mem0 项目端口和接口文档

## 📊 服务端口占用情况

Mem0项目启动后会占用以下端口：

| 端口 | 服务 | 状态 | 用途描述 |
|------|------|------|----------|
| **8004** | **Mem0 API** | ✅ **主服务** | FastAPI Web服务，对外提供API接口 |
| 6333 | Qdrant REST | ✅ 运行中 | 向量数据库REST API，内部使用 |
| 6334 | Qdrant gRPC | ✅ 监听中 | 向量数据库gRPC API，内部使用 |  
| 6379 | Redis | ✅ 监听中 | 缓存数据库，内部使用 |

## 🌐 API接口完整清单

### 📝 记忆管理接口 (核心功能)

#### 创建记忆
```
POST /v1/memories/
```
**功能**: 创建新的记忆条目  
**参数**: JSON格式，包含messages、user_id、agent_id等  
**返回**: 创建成功的记忆ID和内容摘要

#### 获取用户记忆
```
GET /v1/memories/?user_id={user_id}&limit={limit}
```
**功能**: 获取指定用户的记忆列表  
**参数**: user_id(必需)、limit(可选，默认10)  
**返回**: 按时间倒序的记忆列表

#### 获取所有记忆
```
GET /v1/memories/all
```
**功能**: 获取系统中所有用户的记忆，无需任何参数  
**参数**: 无  
**返回**: 按时间倒序的所有记忆列表，包含总数和用户数量统计

#### 搜索记忆 (POST方式 - 推荐)
```
POST /v1/memories/search
```
**功能**: 根据关键词搜索记忆，支持复杂查询  
**参数**: JSON格式，包含query、user_id、limit等  
**返回**: 按相关性排序的搜索结果

#### 搜索记忆 (GET方式 - 简单)
```
GET /v1/memories/search?user_id={user_id}&query={query}&limit={limit}
```
**功能**: 简单的关键词搜索  
**参数**: URL参数形式  
**返回**: 搜索结果列表

### 🔧 系统管理接口

#### 系统统计信息
```
GET /v1/system/stats
```
**功能**: 获取系统运行统计信息  
**返回**: 用户数量、记忆总数、各用户记忆分布等

#### 清理所有数据
```
DELETE /v1/system/clear
```
**功能**: 清理所有存储的记忆数据 (仅用于测试)  
**返回**: 清理操作的统计信息

#### 删除用户记忆
```
DELETE /v1/memories/user/{user_id}
```
**功能**: 删除指定用户的所有记忆  
**参数**: user_id(路径参数)  
**返回**: 删除操作的统计信息

### 📚 文档和基础接口

#### 根路径信息
```
GET /
```
**功能**: 获取API基础信息  
**返回**: 服务名称、版本、状态等

#### 健康检查
```
GET /health
```
**功能**: 检查服务健康状态  
**返回**: 服务状态和各组件连接情况

#### Swagger UI文档
```
GET /docs
```
**功能**: 交互式API文档界面  
**特色**: 支持"Try it out"功能，使用本地资源加载

#### ReDoc文档
```
GET /redoc
```
**功能**: 备选的API文档格式  
**特色**: 更简洁的文档展示风格

#### OpenAPI规范
```
GET /openapi.json
```
**功能**: 获取OpenAPI规范文件  
**用途**: 用于生成客户端代码或第三方工具集成

### 🗄️ 数据库接口

#### Qdrant集合信息
```
GET /v1/collections
```
**功能**: 获取Qdrant向量数据库的集合信息  
**返回**: 集合列表和统计信息

### 📁 静态资源接口

#### 静态文件服务
```
GET /static/*
```
**功能**: 提供本地静态文件访问  
**内容**: CSS、JavaScript、图片等前端资源  
**优势**: 本地加载，速度快，无需外部CDN

## 🚀 访问地址

### 主要访问入口
- **API服务**: http://localhost:8004
- **API文档**: http://localhost:8004/docs
- **健康检查**: http://localhost:8004/health

### 内部服务地址
- **Qdrant管理**: http://localhost:6333/dashboard
- **Redis**: localhost:6379 (命令行访问)

## 🔧 服务架构

### 组件说明
1. **Mem0 API服务** (端口8004)
   - 基于FastAPI框架
   - 提供RESTful API接口
   - 支持真实数据存储和检索
   - 集成Swagger UI文档

2. **Qdrant向量数据库** (端口6333/6334)
   - REST API: 6333端口
   - gRPC API: 6334端口
   - 用于向量存储和相似度搜索

3. **Redis缓存** (端口6379)
   - 提供缓存服务
   - 支持会话管理

## 🌟 特色功能

### 真实数据存储
- ✅ 真实记忆创建和存储
- ✅ 用户隔离的数据管理
- ✅ 时间排序的记忆检索
- ✅ 关键词匹配的智能搜索

### 本地资源优化
- ✅ Swagger UI本地资源(1.6MB)
- ✅ 快速加载，无需外部CDN
- ✅ 离线可用的API文档

### 中文优化
- ✅ 支持中文内容存储
- ✅ 中文关键词搜索
- ✅ 中文API文档界面

## 🚨 安全和部署注意事项

### 端口开放策略
- **对外开放**: 仅需开放8004端口
- **内部通信**: 6333、6334、6379端口仅供内部服务使用
- **防火墙设置**: 建议只允许信任的IP访问

### 数据安全
- **数据隔离**: 基于user_id的严格用户隔离
- **访问控制**: 建议在生产环境中添加认证机制
- **数据持久化**: 当前为内存存储，重启后数据丢失

### 性能优化
- **连接池**: Qdrant和Redis使用连接池
- **静态资源**: 本地CDN避免网络延迟
- **缓存策略**: 浏览器缓存优化

## 📋 使用检查脚本

项目提供了便捷的端口检查脚本：

```bash
# 检查所有服务状态
./check-ports.sh

# 管理静态资源
./manage-static-resources.sh status
```

## 🔄 版本信息

- **API版本**: 1.0.0-test
- **Swagger UI**: 5.17.14 (本地版本)
- **Qdrant**: latest
- **Redis**: 7-alpine
- **Python**: 3.11+

---

📅 **文档更新时间**: 2025-08-16  
📝 **维护说明**: 此文档记录了Mem0项目的完整端口和接口信息，建议在服务变更时及时更新